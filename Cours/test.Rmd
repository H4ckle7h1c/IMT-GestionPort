---
title: "Untitled"
author: "P. Henaff"
date: "3/23/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

$$
x_1 = x_2 = x_3
$$
$$
0 \leq x_i \leq 1
$$
$$
\sum_i x_i = 1
$$
```{r}
sigma <- c(.1, .2, .3)
rho <- matrix(c(1, .8, .7, .8, 1, .6, .7, .6, 1), nrow=3)
Sigma <- diag(sigma) %*% rho %*% diag(sigma)

obj <- function(w) {
  w <- matrix(w, ncol=1)
  Sw <- Sigma %*% w
  ContribRisque <- w * Sw
  sum(diff(ContribRisque)^2) * 10^4
}

Aeq <- matrix(rep(1,3), nrow=1)
Beq <- 1
lb <- rep(0,3)
ub <- rep(1,3)
x.0 <- c(1,1,1)
res <- solnl(X=x.0, objfun=obj, Aeq=Aeq, Beq=Beq, lb=lb, ub=ub)
res$par
```


```{r}
sigma <- c(.1, .2, .3)
rho <- matrix(c(1, .8, .7, .8, 1, .6, .7, .6, 1), nrow=3)
Sigma <- diag(sigma) %*% rho %*% diag(sigma)
Sigma
```